---
layout: post
title:  "AWS Solutions Architect - Associate (SAA-C02) 문제풀이"
author: aloa
categories: [ AWS SAA ]
---

<img src="/assets/images/AWS/SAA_C02_01.PNG"/>

정답은 <span class="spoiler">A 입니다.</span>

- Keyword : Application Load Balancer

<img class="center" src="/assets/images/AWS/SAA_C02_01_01.png"/>

ALB는 인스턴스들의 상태를 확인하기 위해 지정된 프로토콜및 포트로 Target Group에게 주기적 요청을 보냅니다. Health Check를 통과하여 장애가 없는 타겟에만 트래픽을 보내며, 만약에 장애가 발생한 타겟이 있다면, 해당 인스턴스에는 요청을 보내는 것을 중지합니다.

트래픽별 다른 Target Group에게 요청을 보낼 수 있습니다(Rule). 

HTTP/HTTPS/Websocket 프로트콜은 ALB 이며, TCP 프로토콜은 NLB입니다. NLB는 매우 낮은 지연시간을 가지고 있으므로 extreme performance가 필요한 어플리케이션에 적합합니다. 

또한, 인스턴스는 클라이언트의 주소를 직접알 수 없으며, ELB의 프라이빗 아이피를 압니다. 클라이언트 주소는 헤더 (X-Forwarded-For)에 입력되어 있습니다. 

<hr>
<img src="/assets/images/AWS/SAA_C02_02.PNG"/>

정답은 <span class="spoiler">D 입니다.</span>

- Keyword : <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-short-and-long-polling.html" target="_blank">Short polling, Long polling</a>

<img class="center" src="/assets/images/AWS/SAA_C02_02_01.png"/>

AWS SQS(Simple Queue Service)의 Consumer는 Queue로부터 short polling 또는 Long polling으로 메시지를 가져올 수 있습니다. Short polling 일 경우, SQS는 빈 응답(Empty Response)라도 즉시 응답을 합니다. Short polling 일 경우, SQS는 메시지가 있을 때만, 응답을 주무로, 더 저렴한 방식입니다. 본 문제에서는 빈 응답수를 최소화하여 비용을 줄이고자하므로, Long polling으로 바꾸어야 합니다. Long polling의 변경은 ReceiveMessageWaitTimeSeconds(수신메시지 대기 시간)을 0 이상으로 설정함으로써, 적용할 수 있습니다. 
<hr>
<img src="/assets/images/AWS/SAA_C02_03.PNG"/>

정답은 <span class="spoiler">B 입니다.</span>

- Keyword : Volume Gateway

Volume Gateway에서 Stored mode는 온프레미스 저장소의 전체 데이터를 저장하므로 낮은 지연시간을 제공하며, 볼륨 변경시마다 S3에 EBS(Elastic Block Store) 스냅샷이 보관되어 지속성을 높일 수 있습니다. 반면, Cached mode는 온프레미스 저장소를 확장할 필요없이, 클라우드 저장소의 저장공간을 사용할 수 있습니다. 즉, 볼륨에 쓴 데이터를 S3에 저장되며, 최근에 읽은 데이터를 온프레미스 저장소에 캐싱합니다.

<img class="center" src="/assets/images/AWS/SAA_C02_03_01.png"/>

A) AWS Transfer : S3 저장소에 파일을 전송하기 위한 SFT, FTP등의 파일 송수신 서비스입니다.<br/>
C) AWS DataSync  : 온프레미스와 AWS 스토리지간 데이터 이동을 지원하는 서비스입니다.<br/>

<hr>
<img class="question" src="/assets/images/AWS/SAA_C02_04.PNG"/>

정답은 <span class="spoiler">A,B 입니다.</span>

- Keyword : NAT(Network Address Translation) Gateway

일반적인 예로 VPC 내의 퍼블릭 서브넷에는 웹서버를 두고 프라이빗 서브넷에는 DB서버를 두는 웹사이트가 있습니다. 퍼블릿 서브넷의 인스턴스는 인터넷에 아웃바운드 트래픽(인터넷->인스턴스)을 전송할 수 있지만, 프라이빗 서브넷은 인터넷과 연결이 되있지 않습니다. 하지만, 프라이빗 서브넷의 인바운드는 필요가 없더라도 인스턴스의 펌웨어 혹은 주기적인 업데이트로 인해 아웃바운드 트래픽이 허용되어야 할 경우가 있습니다. 본 문제는 니와 같이 프라이빗 서브넷 안에 있는 인스턴스의 소프트웨어 패치가 필요한 상황입니다. 이런 경우, 퍼블릭 서브넷에서 NAT게이트웨이를 생성한 후, 프라이빗 네트워크의 라우팅 테이블 업데이트 하여 패치를 가져올 수 있습니다. 

- Public subnet : Internet Gateway / ELB / Public IP, Elastic IP / Net Instance
- Private subnet : private ip / internet inbound, outbound x / connection w/ other subnets
<hr>
<img class="question" src="/assets/images/AWS/SAA_C02_05.PNG"/>

정답은 <span class="spoiler">A,B 입니다.</span>

- Keyword : <a href ="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-lifecycle.html" target="_blank">Instance Hibernation</a>

Instance Hibernation(최대절전모드 또는 수면모드)는 루트 볼륨이 EBS일 경우일 때만 가능합니다(인스턴스 스토어 x). 수면모드를 설정하면 램이 EBS 루트 볼륨에 저장되면서, 나중에 다시 실행될 때, 복구가 됩니다. 인스턴스는 중지된 상태로 비용이 청구가 안되고, EBS 와 Elastic IP 에 비용이 청구되므로 효율적 운영이 가능합니다. 사례는 <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-lifecycle.html">이 글</a>에서 볼수 있습니다.

<img src="/assets/images/AWS/SAA_C02_06.PNG"/>

정답은 <span class="spoiler">C,D 입니다.</span>

- Keyword : <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/MultipleIP.html" target="_blank">Multiple IP Addresses</a>, 

- Multiple IP Addresses

Multiple IP Addresses 는 하나의 인스턴스로 들어오는 트래픽의 앱이 가용하지 않을 경우, 보조 ENI를 두어 대기중인 인스턴스로 가도록 할 수 있다. 

<img src="/assets/images/AWS/SAA_C02_06_01.png"/>

그 외에, 네트워크를 분리하여 한 서버의 여러개의 웹사이트를 운영하기 또는 방화벽, 로드 발란서 등 각 네트워크 마다 다중 아이피를 갖는 네트워크 어플라이언스에 사용될 수 있다. 

하지만, <a href="https://stackoverflow.com/questions/36608349/aws-elastic-ip-vs-eni" target="_blank">본 글</a>에 따르면 높은 가용성을 얻기 위해 ENI말고도 ELB 사용, Elastic IP사용들을 검토할 수 있다. 

EC2의 Public 는 인스턴스의 시작 및 종료와 함께 변화된다. 하지만, fixed public IP 를 사용하고 싶을 때, Elastic IP 를 사용할 수 있다. 따라서, 해당 인스턴스에 장애 발생 시, 다른 인스턴스로 신속히 매핑이 가능하다.

하지만, Elastic IP 와 ENI 방식은 하나의 인스턴스가 모든 트래픽을 받으므로, 가장 추천하는 방식은 ELB 방식이다.

<hr>

<img src="/assets/images/AWS/SAA_C02_07.PNG"/>

정답은 <span class="spoiler">C,D 입니다.</span>

- Keyword : CORS

<hr>
<img src="/assets/images/AWS/SAA_C02_08.PNG"/>

정답은 <span class="spoiler">C,D 입니다.</span>

- Keyword : SSE-S3, SSE-KMS, SSE-C

- Server-side encryption with Amazon S3-Managed Keys(SSE-S3)

S3가 제공하는 Unique Key 사용하여 암호화할 수 있도록 해준다. 이 키는 마스터 키에의해 주기적으로 암호화되면서 변경된다.

<img src="/assets/images/AWS/SAA_C02_08_01.png"/>
<hr>
- Server-side encryption with Customer Master Keys(CMKs) Stored in AWS Key Management Service(SSE-KMS)  

KMS가 관리하는 CMK를 사용하여 암호화할 수 있도록 해준다. 

<img src="/assets/images/AWS/SAA_C02_08_02.png"/>
<hr>
- Server-side encryption with Customer-Provided Encryption Keys(SSE-C)  

당신이 가진 암호화 방식으로 암호화할 수 있도록 해준다. 

<img src="/assets/images/AWS/SAA_C02_08_03.png"/>
<hr>

<img class="question" src="/assets/images/AWS/SAA_C02_09.PNG"/>

정답은 <span class="spoiler">A 입니다.</span>

- Keyword : S3 Object Storage
<img class="center" src="/assets/images/AWS/SAA_C02_09_01.png"/>

<hr>
<img src="/assets/images/AWS/SAA_C02_10.PNG"/>

정답은 <span class="spoiler">A,B 입니다.</span>

- Keyword : Spot Instance
<img class="center" src="/assets/images/AWS/SAA_C02_10_01.png"/>

A. 온디맨드 인스턴스 : 
- 장기 약정이 없다<br/>
- 중단되어서는 안되는 어플리케이션 적합하다<br/>
- Amazon EC2에서 처음으로 개발 또는 시험 중인 어플리케이션<br/>

B. 예약 인스턴스 : 
- 1-3년 장기 약정이 있다<br/>
- 안정적인 수요를 가진 어플리케이션에 적합하다<br/>

C. 스팟 인스턴스 : 
- 스팟가격이 최대입찰가격보다 적을시, 인스턴스가 실행되며, 스팟가격이 최대입찰가격보다 높을시, 인스턴스가 종료된다(Spot instance interruption)<br/>
- 따라서, 중단될 수 있는 어플리케이션에 적합하다<br/>

<hr>